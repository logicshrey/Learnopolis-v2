"use strict";(()=>{var e={};e.id=277,e.ids=[277],e.modules={1185:e=>{e.exports=require("mongoose")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6249:(e,o)=>{Object.defineProperty(o,"l",{enumerable:!0,get:function(){return function e(o,n){return n in o?o[n]:"then"in o&&"function"==typeof o.then?o.then(o=>e(o,n)):"function"==typeof o&&"default"===n?o:void 0}}})},5941:(e,o,n)=>{n.r(o),n.d(o,{config:()=>c,default:()=>l,routeModule:()=>g});var t={};n.r(t),n.d(t,{default:()=>s});var r=n(1802),i=n(7153),a=n(6249),u=n(2250),d=n(6749);async function s(e,o){if("GET"!==e.method)return o.status(405).json({message:"Method not allowed"});try{await (0,u.u)();let{difficulty:n,subject:t,limit:r,videoId:i}=e.query,a={};n&&(a.difficulty=n),t&&(a.subject=t),i&&(a._id=i);let s=d.Z.find(a).sort({createdAt:-1});r&&!isNaN(Number(r))&&(s=s.limit(Number(r)));let l=await s;console.log(`Found ${l.length} videos matching query:`,a),o.status(200).json({videos:l})}catch(e){console.error("Error fetching videos:",e),o.status(500).json({message:"Error fetching videos"})}}let l=(0,a.l)(t,"default"),c=(0,a.l)(t,"config"),g=new r.PagesAPIRouteModule({definition:{kind:i.x.PAGES_API,page:"/api/videos",pathname:"/api/videos",bundlePath:"",filename:""},userland:t})},2250:(e,o,n)=>{n.d(o,{u:()=>u});var t=n(1185),r=n.n(t);let i=process.env.MONGODB_URI||"mongodb://localhost:27017/learnopolis";if(!i)throw Error("Please define the MONGODB_URI environment variable");let a=global.mongoose;async function u(){return a.conn||(a.promise||(console.log("Connecting to MongoDB..."),a.promise=r().connect(i,{bufferCommands:!1}).then(e=>(console.log("Connected to MongoDB"),e)).catch(e=>{throw console.error("Error connecting to MongoDB:",e),e})),a.conn=await a.promise),a.conn}a||(a=global.mongoose={conn:null,promise:null}),r().connection.on("error",e=>{console.error("MongoDB connection error:",e)})},6749:(e,o,n)=>{n.d(o,{Z:()=>a});var t=n(1185),r=n.n(t);let i=new(r()).Schema({title:{type:String,required:!0,trim:!0},description:{type:String,required:!0},videoId:{type:String,required:!0,unique:!0},difficulty:{type:String,enum:["beginner","intermediate","advanced"],required:!0},subject:{type:String,required:!0},duration:{type:Number,required:!0},createdAt:{type:Date,default:Date.now}}),a=r().models.Video||r().model("Video",i)},7153:(e,o)=>{var n;Object.defineProperty(o,"x",{enumerable:!0,get:function(){return n}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(n||(n={}))},1802:(e,o,n)=>{e.exports=n(145)}};var o=require("../../webpack-api-runtime.js");o.C(e);var n=o(o.s=5941);module.exports=n})();